---
layout: post
title: "[ë°°ê²½ì§€ì‹] Graphics and Math"
date: 2023-04-18
categories: CV
photos: /assets/post_images/titleImg/CGM2.png
tags: [graphics, math, ë°°ê²½ì§€ì‹] 
description: "Graphics and Math í•™ìŠµ"
published: true
use_math: true
---

<br/>
<br/>

#ë¯¸ì™„ì„±

# Computer graphics and Math

<br/>

## 1. **column major, row major**

<br/>

2ì°¨ì› ì´ìƒì˜ ë°°ì—´ì„ ì €ì¥í•  ë•Œ ì ìš©ë˜ëŠ” ê°œë…ì´ë‹¤. ê³ ì°¨ì›ì˜ ë°°ì—´ì— ê²½ìš°ì¼ ì§€ë¼ë„ ê²°êµ­ ì €ì¥ì¥ì¹˜ì—ëŠ” 1ì°¨ì›ìœ¼ë¡œ ì €ì¥ëœë‹¤. ì´ë•Œ column majorì€ ìƒˆë¡œ(ì—´)ìˆœìœ¼ë¡œ row majorì€ ê°€ë¡œ(í–‰)ìˆœìœ¼ë¡œ ì €ì¥ì´ ëœë‹¤.

![Untitled](/assets/post_images/CGandMath/Untitled.png)

![Untitled](/assets/post_images/CGandMath/Untitled%201.png)

ì´ëŸ¬í•œ íŠ¹ì§•ìœ¼ë¡œ ì¸í•˜ì—¬ ë©”ëª¨ë¦¬ ì£¼ì†Œì— ëŒ€í•œ ì ‘ê·¼ ë°©ë²•ì´ ë‹¬ë¼ì§„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ column/row majorë³„ ë©”ëª¨ë¦¬ ì£¼ì†ŒëŠ” ì–´ë–»ê²Œ ë‹¬ë¼ì§ˆê¹Œ? 

ex) a[3][4] í¬ê¸°ì¸ intí˜• 2ì°¨ì› ë°°ì—´ì—ì„œ a[x][y]ì˜ ë©”ëª¨ë¦¬ ì£¼ì†ŒëŠ” ì–´ë–»ê²Œ ë ê¹Œ?

```cpp
//address a[x][y] in row major
&a[0][0] + (4*x + y)*4

//address a[x][y] in column major
&a[0][0] + (4*y + x)*4
```

> row major : C/C++/Objective-C (for C-style arrays), DirectX
col major : OpenGl,glm, S-Plus, R
> 

row major ì€ í‰ì†Œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì—ì„œ 2ì°¨ì› ë°°ì—´ì„ ì €ì¥í•˜ë˜ ë°©ì‹ìœ¼ë¡œ ì§ê´€ì ì´ì§€ë§Œ, tranform ì—°ì‚°ê³¼ cache ê´€ì ì—ì„œëŠ” ë¹„íš¨ìœ¨ì ì´ê¸° ë•Œë¬¸ì— col majorê°€ ë“±ì¥í•˜ì˜€ë‹¤. 

ex) Matrix ì„ ì–¸ì‹œ í™˜ê²½ì— ë”°ë¼ ì˜ ì„ ì–¸í•´ì•¼í•œë‹¤

```python
#ì €ì¥í•˜ê³  ì‹¶ì€ matrix(row major ê¸°ì¤€)
mat4(
  1.0, 5.0, 9.0, 13.0,
  2.0, 6.0, 10.0, 14.0,
  3.0, 7.0, 11.0, 15.0,
  4.0, 8.0, 12.0, 16.0
);

//panda 3dë¡œ ì €ì¥
LMatrix4F.__init__(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16)

#ì‹¤ì œë¡œ ì €ì¥ëœ ê°’(row major ê¸°ì¤€)
transpose(mat4(
  1.0, 5.0, 9.0, 13.0,
  2.0, 6.0, 10.0, 14.0,
  3.0, 7.0, 11.0, 15.0,
  4.0, 8.0, 12.0, 16.0
);
#ì˜ˆì‹œê°€ ìƒë‹¹íˆ ë³µì¡í•˜ë‹¤ ì˜ëª»ë§Œë“ ë“¯ã…œã…œ
```

Transform ë‹¨ê³„ì˜ ì£¼ì˜ ì‚¬í•­

ì´ëŸ¬í•œ êµ¬ì¡°ëŠ” ì»´í“¨í„° ê·¸ë˜í”½ìŠ¤ì—ì„œ transformì‹œ í–‰ë ¬ ì—°ì‚°ì˜ ìˆœì„œê°€ ë³€í•œë‹¤. í–‰ë ¬ê³±ì—ëŠ” ê²°í•©ë²•ì¹™( associative law )ì´ ì ìš©ë˜ì§€ë§Œ êµí™˜ë²•ì¹™( communitative law )ì€ ì ìš©ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤. 

> row major :  Model T * World T * View  T * Projection T (ìˆœì°¨ì ìœ¼ë¡œ ,append)
col major : Projection T * View T * World T * Model T (ë¨¼ ë³€í™˜ì´ ì•ì— ,stack )
êµ³ì´ ì´ëŸ¬í•œ row majorì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¼ê¹Œ?   ì•ì„œ ë§í•œ ê²ƒì²˜ëŸ¼ ì§ê´€ì ì´ê³ , transform ì—°ì‚°ë§Œ ì•„ë‹ˆë¼ë©´ ë¬¸ì œë ê²Œ í¬ê²Œ ì—†ë‹¤.
> 

ì¢€ ë” ì§ê´€ì ì¸ ì˜ˆë¥¼ ë“¤ì–´ ë§Œì•½ ë¬¼ì²´ í¬ê¸°ë¥¼ í‚¤ìš°ê³ (S) ì´ë™ ì‹œí‚¤ê³ (T) ì‹¶ë‹¤ë©´

col majorì˜ ê²½ìš° T*S ì˜ ê³¼ì •ì„ ê±°ì¹˜ë©°, row majorì˜ ê²½ìš° S*Tì˜ ê³¼ì •ì„ ê±°ì¹œë‹¤.

> LHS : ì£¼ë¡œ row majorì™€ í•¨ê»˜ ì‚¬ìš©ëœë‹¤.
RHS : ì£¼ë¡œ column majorì™€ í•¨ê»˜ ì‚¬ìš©ëœë‹¤.
ë°˜ë“œì‹œ ê·¸ëŸ°ê±´ ì•„ë‹ˆë‹¤. ex) panda3d
> 
> - ê° ì¢Œí‘œê³„  ì‚¬ì´ ë³€í™˜ì„ ì›í•œë‹¤ë©´ y ì¶• ë°˜ì „ì„ ì‹œì¼œì£¼ë©´ ëœë‹¤

<aside>
ğŸ’¡ í•„ìê°€ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” Unreal Engineì˜ ê²½ìš° CPU, GPU ëª¨ë‘ row major ì´ê¸°ì— pre multiplied ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤. í•˜ì§€ë§Œ GLSLì˜ ê²½ìš° column majorì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— UE í”„ë¡œì íŠ¸ì™€ ì—°ë™í•˜ì—¬ shader codingì„ í•  ê²½ìš° ì£¼ì˜í•˜ì—¬ì•¼ í•  ê²ƒ ê°™ë‹¤. (transforse ê´€ë ¨)

</aside>

<br/>

## 2. Scene Graph

<br/>

![Untitled](/assets/post_images/CGandMath/Untitled%202.png)

graph ë‚˜ tree ì™€ ìœ ì‚¬í•œ hieraticialêµ¬ì¡°ë¡œ nodeë¥¼ ì €ì¥í•˜ëŠ” ê²ƒ, ì´ëŸ¬í•œ êµ¬ì¡°ê°€ obj ì´ë™ì˜ ì—°ì‚°ì„ ë”ìš± ì‰½ê²Œ ë§Œë“¤ì–´ì£¼ë©°, ì´ëŠ” ê·¸ë˜í”½ìŠ¤ì—ì„œ ë„ˆë¬´ë‚˜ ì¤‘ìš”í•˜ê³  í•„ìˆ˜ì ì¸ êµ¬ì¡°ì´ë‹¤ (ì €ëª…í•œ ì´ì•¼ê¸°ê¸° ë•Œë¬¸ì— ë”°ë¡œ ìì„¸í•œ ì„¤ëª…ì€ ìƒëµí•˜ë„ë¡ í•˜ê² ë‹¤)

<br/>


## 3. Homogeneous Coordinates

<br/>

ì™œ x,y,z ì¶•ë§Œì´ ì¡´ì¬í•˜ëŠ” ì¢Œí‘œê³„ì—ì„œ 4x4ì˜ transformation matrix ë¥¼ ì‚¬ìš©í• ê¹Œ?  ë°”ë¡œ rotationê³¼ translationì„ í•˜ë‚˜ì˜ í–‰ë ¬ë¡œ ì •ì˜í•˜ê¸° ìœ„í•´ì„œ ì´ë‹¤. 

<br/>

## 4. space transform

<br/>

ì•ì„œ ê³„ì† transform ì´ë¼ëŠ” ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤. transformì€ ì–´ë– í•œ ë¬¼ì²´ ë“±ì˜ ì¤‘ì‹¬ ì¢Œí‘œë¥¼ ë°”ê¾¸ëŠ” ê³¼ì • í˜¹ì€ matrix ë¼ê³  ë³¼ ìˆ˜ ìˆë‹¤.

<br/>

## 5. rendering

<br/>

3d scene ì„ 2d ì´ë¯¸ì§€ë¡œ ë³€í™˜ íˆ¬ì˜í•˜ëŠ” ê³¼ì •ì„ ì˜ë¯¸í•œë‹¤. ê°€ë³ê²Œ ê°œë…ì •ë„ë§Œ  ì •ë¦¬í•˜ê³  ë„˜ì–´ê°€ê² ë‹¤.

<br/>

- World(Model) transform : ê°ì²´(material, light source)ë¥¼ world spaceë¡œ ë³´ë‚´ëŠ” ê³¼ì •ìœ¼ë¡œ openglì—ì„œëŠ” Model transform ì´ë¼ê³  ë¶€ë¥¸ë‹¤.
- Viewing transform : World space to Camera space (ê²½ìš°ì— ë”°ë¼ ë‹¤ë¥´ì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ camera model transformì˜ inverse transformì´ ë  ìˆ˜ ìˆë‹¤)
    - camera space ì¹´ë©”ë¼ì˜ viewing directionì€ ì¼ë°˜ì ìœ¼ë¡œ -z ì¶•ì„ ë°”ë¼ë³´ë„ë¡ ì„¤ê³„ëœë‹¤. (ë”°ë¼ì„œ Sceneì— ë³´ì´ëŠ” ë¬¼ì²´ë“¤ì€ -z ì¢Œí‘œìƒì— ìœ„ì¹˜í•˜ê²Œ ëœë‹¤)
        - lookat interface : Lookat(position, viewing vector, up vector)ì˜ 3ê°€ì§€ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ view transformì„ ì–»ì„ ìˆ˜ ìˆë‹¤, ê·¸ëŸ¼ ì‘ìš©ì´ ê°€ëŠ¥í•˜ë‹¤,  ì¢Œí‘œ ë‘ê°œë‘ ì•Œë©´, vì— ìŒìˆ˜ê°’? lookat ì— inverse ì·¨í•˜ë©´ model transform
- Projection transform : Camera space to Projection space (perspective, orthogonal) opengl, directX ì°¨ì´ ë°œìƒ, ì˜¤ë¥¸ì† â†’ ì™¼ì†ì¢Œí‘œê³„ë¡œ ë³€í™˜(depth test ì‹œ ìŒìˆ˜ ê³„ì‚°ì´ ë”ìš± ì˜¤ë˜ ê±¸ë¦¬ê¸°ì— ë³€í™˜)
- Viewport Transform :  Projection spaceì—ì„œ clipingë“±ì˜ ê³¼ì •ì„ ê±°ì³ ìµœì¢…ì ìœ¼ë¡œ rendering ì— ëŒ€ìƒì´ ëœ ê°’ì„ Screen Spaceì˜ ê°’ìœ¼ë¡œ ë³€í™˜

<br/>

ìœ„ ê³¼ì •ì€ ë‹¤ì†Œ ë³µì¡í•œ ê³¼ì •ì´ê¸°ë„ í•˜ê³  Screen Space to World Space ê°™ì€ ë‚´ìš©ë„ ìì„¸íˆ ë‹¤ë£¨ê³  ì‹¶ê¸° ë•Œë¬¸ì— ê¸°íšŒê°€ ëœë‹¤ë©´ ë³„ë„ë¡œ ì •ë¦¬í•´ ë³´ê² ë‹¤. 

<br/>

<aside>
ğŸ’¡ world space : 3dë¡œ ë˜ì–´ìˆì€ ê°€ìƒ ì„¸ê³„
screen space : x,y ë¡œ pixel ì´mapping ë˜ë©°, ë³„ë„ì˜ depth ê°’ì„ ê°–ëŠ”ë‹¤.(?!)

</aside>
<br/>

- convention : í‘œí˜„ì˜ ì•½ì† ê·œìœ¨ í†µì¼ì„ ì˜ë¯¸

<br/>

ê¶ê¸ˆí•œ ì ì´ ìˆë‹¤ë©´ ë‚¨ê²¨ì£¼ì„¸ìš”! í•¨ê»˜ ê³ ë¯¼í•´ ë³´ê² ìŠµë‹ˆë‹¤.

------------------------